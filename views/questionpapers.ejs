<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Question Paper</title>
    <script src='https://kit.fontawesome.com/a076d05399.js' crossorigin='anonymous'></script>

    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css">

    <style>
        #searchInput {
            margin-right: 0;

        }


        .table th,
        .table td {
            font-size: 14px;

        }


        .mb-3 {
            margin-bottom: 10px;

        }

        .mt-3 {
            margin-top: 20px;

        }

        .mt-5 {
            margin-top: 20px;

        }

        .table-responsive {
            overflow-x: auto;
        }
    </style>
</head>

<body>
    <nav class="navbar navbar-expand-lg navbar-light bg-light shadow">
        <a class="navbar-brand" href="#">TestMaster <sub>by Algodomain Solutions</sub></a>
        <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarNav"
            aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation">
            <span class="navbar-toggler-icon"></span>
        </button>
        <div class="collapse navbar-collapse" id="navbarNav">
            <ul class="navbar-nav ml-auto">
                <li class="nav-item">
                    <a class="nav-link" href="/testmaster/api/questionpapers">Question Papers </a>
                </li>
                <li class="nav-item">
                    <a class="nav-link  " href="/questions-list">Questions</a>
                </li>
                <li class="nav-item">
                    <a class="nav-link " href="/upload">Create Questions</a>
                </li>
                <li class="nav-item">
                    <a class="nav-link " href="/results">Results</a>
                </li>
            </ul>
        </div>
    </nav>


    <div class="container">
        <div class="mb-3">
            <a class="btn btn-success float-right shadow " href="/addquestionpaper">Create Question Paper</a>
        </div>



        <div class="table-responsive ">
            <table class="table table-bordered mt-3 shadow">
                <thead>
                    <tr>
                        <th class="text-center">S. No.</th>
                        <th class="text-center">Question Paper Title</th>
                        <th class="text-center">Total Questions</th>
                        <th class="text-center">Time</th>
                        <th class="text-center">Minimum Attempts for Passing</th>
                        <th class="text-center">Send to Candidate</th>
                        <th class="text-center">Actions</th>

                    </tr>
                </thead>
                <tbody>
                    <% questionPapers.forEach((questionPaper,index)=> { %>
                        <tr>
                            <td class="text-center">
                                <%= index + 1%>
                            </td>
                            <td class="text-center">
                                <%= questionPaper.questionPaperTitle %>
                            </td>
                            <td class="text-center">
                                <%= questionPaper.questionIds.length %>
                            </td>
                            <td class="text-center">
                                <%= questionPaper.time %>
                            </td>
                            <td class="text-center">
                                <%= questionPaper.minimumNumberForPassing %>
                            </td>
                            <td class="text-center">
                                <button class="btn border border-black w-25 h-25  rounded shadow"
                                    onclick="sendQuestionPaper('<%= questionPaper._id %>')">
                                    <svg xmlns="http://www.w3.org/2000/svg" height="1em" viewBox="0 0 576 512">
                                        <path
                                            d="M352 224H305.5c-45 0-81.5 36.5-81.5 81.5c0 22.3 10.3 34.3 19.2 40.5c6.8 4.7 12.8 12 12.8 20.3c0 9.8-8 17.8-17.8 17.8h-2.5c-2.4 0-4.8-.4-7.1-1.4C210.8 374.8 128 333.4 128 240c0-79.5 64.5-144 144-144h80V34.7C352 15.5 367.5 0 386.7 0c8.6 0 16.8 3.2 23.2 8.9L548.1 133.3c7.6 6.8 11.9 16.5 11.9 26.7s-4.3 19.9-11.9 26.7l-139 125.1c-5.9 5.3-13.5 8.2-21.4 8.2H384c-17.7 0-32-14.3-32-32V224zM80 96c-8.8 0-16 7.2-16 16V432c0 8.8 7.2 16 16 16H400c8.8 0 16-7.2 16-16V384c0-17.7 14.3-32 32-32s32 14.3 32 32v48c0 44.2-35.8 80-80 80H80c-44.2 0-80-35.8-80-80V112C0 67.8 35.8 32 80 32h48c17.7 0 32 14.3 32 32s-14.3 32-32 32H80z" />
                                    </svg>
                                </button>
                            </td>
                            <td class="text-center">
                                <button class="btn border border-black rounded shadow"
                                    onclick="editQuestionPaper('<%= questionPaper._id %>')">
                                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor"
                                        class="bi bi-pen" viewBox="0 0 16 16">
                                        <path
                                            d="m13.498.795.149-.149a1.207 1.207 0 1 1 1.707 1.708l-.149.148a1.5 1.5 0 0 1-.059 2.059L4.854 14.854a.5.5 0 0 1-.233.131l-4 1a.5.5 0 0 1-.606-.606l1-4a.5.5 0 0 1 .131-.232l9.642-9.642a.5.5 0 0 0-.642.056L6.854 4.854a.5.5 0 1 1-.708-.708L9.44.854A1.5 1.5 0 0 1 11.5.796a1.5 1.5 0 0 1 1.998-.001zm-.644.766a.5.5 0 0 0-.707 0L1.95 11.756l-.764 3.057 3.057-.764L14.44 3.854a.5.5 0 0 0 0-.708l-1.585-1.585z" />
                                    </svg>
                                </button>


                                <button class="btn  border  border-black rounded shadow  "
                                    onclick="deleteQuestionPaper('<%= questionPaper._id %>')">
                                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor"
                                        class="bi bi-trash" viewBox="0 0 16 16">
                                        <path
                                            d="M5.5 5.5A.5.5 0 0 1 6 6v6a.5.5 0 0 1-1 0V6a.5.5 0 0 1 .5-.5Zm2.5 0a.5.5 0 0 1 .5.5v6a.5.5 0 0 1-1 0V6a.5.5 0 0 1 .5-.5Zm3 .5a.5.5 0 0 0-1 0v6a.5.5 0 0 0 1 0V6Z" />
                                        <path
                                            d="M14.5 3a1 1 0 0 1-1 1H13v9a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V4h-.5a1 1 0 0 1-1-1V2a1 1 0 0 1 1-1H6a1 1 0 0 1 1-1h2a1 1 0 0 1 1 1h3.5a1 1 0 0 1 1 1v1ZM4.118 4 4 4.059V13a1 1 0 0 0 1 1h6a1 1 0 0 0 1-1V4.059L11.882 4H4.118ZM2.5 3h11V2h-11v1Z" />
                                    </svg>
                                </button>
                            </td>

                        </tr>
                        <% }); %>
                </tbody>
            </table>
        </div>
    </div>
    <script>
        function editQuestionPaper(questionPaperId) {
            // Set the questionPaperId in local storage
            localStorage.setItem('questionPaperId', questionPaperId);

            // Redirect to the Question Paper Details page with the questionPaperId as a query parameter
            window.location.href = `/testmaster/api/questionpapersdetails/${questionPaperId}`;
        }

        function sendQuestionPaper(questionPaperId) {
            window.location.href = `/testmaster/api/candidates/${questionPaperId}`;
        }

        function deleteQuestionPaper(questionPaperId) {
            console.log(questionPaperId)
            const confirmed = confirm(
                "Are you sure you want to delete this question paper?"
            );
            if (confirmed) {
                fetch(
                    `http://testmaster.algodomain.in/testmaster/api/questionpapers/${questionPaperId}`,
                    {
                        method: "DELETE",
                    }
                )
                    .then((response) => {
                        if (response.ok) {
                            window.location.reload();
                        } else {
                            console.error("Error deleting question paper");
                        }
                    })
                    .catch((error) => {
                        console.error("Error deleting question paper:", error);
                    });
            }
        }

    </script>


    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.16.0/umd/popper.min.js"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js"></script>
</body>

</html>