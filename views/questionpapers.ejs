<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Test Results</title>

    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css">
    <style>
        /* Adjust the margin for the search bar */
        #searchInput {
            margin-right: 0;
            /* Remove right margin */
        }

        /* Reduce font size */
        .table th,
        .table td {
            font-size: 14px;
            /* Adjust font size as needed */
        }

        /* Add margin between search bar, navigation tabs, and table */
        .mb-3 {
            margin-bottom: 10px;
            /* Add margin at the bottom of the search bar */
        }

        .mt-3 {
            margin-top: 20px;
            /* Add margin at the top of the navigation tabs */
        }

        .mt-5 {
            margin-top: 20px;
            /* Add margin at the top of the table */
        }

        /* Make the table responsive */
        .table-responsive {
            overflow-x: auto;
        }
    </style>
</head>

<body>
    <nav class="navbar navbar-expand-lg navbar-light bg-light shadow">
        <a class="navbar-brand" href="#">TestMaster <sub>by Algodomain Solutions</sub></a>
        <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarNav"
            aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation">
            <span class="navbar-toggler-icon"></span>
        </button>
        <div class="collapse navbar-collapse" id="navbarNav">
            <ul class="navbar-nav ml-auto">
                <li class="nav-item">
                    <a class="nav-link " href="/results">Results</a>
                </li>
                <li class="nav-item">
                    <a class="nav-link " href="/upload">Create Questions</a>
                </li>
                <li class="nav-item">
                    <a class="nav-link  " href="/questions-list">Questions</a>
                </li>
                <li class="nav-item">
                    <a class="nav-link" href="/testmaster/api/questionpapers">Questions Papers</a>
                </li>
            </ul>
        </div>
    </nav>


    <div class="container">
        <div class="mb-3">
            <a class="btn btn-success float-right shadow " href="/addquestionpaper">Create Question Paper</a>
        </div>



        <div class="table-responsive ">
            <table class="table table-bordered mt-3 shadow">
                <thead>
                    <tr>
                        <th class="text-center">S. No.</th>
                        <th class="text-center">Question Paper Title</th>
                        <th class="text-center">Total Questions</th>
                        <th class="text-center">Minimum Attempts for Passing</th>
                        <th class="text-center">Actions</th>

                    </tr>
                </thead>
                <tbody>
                    <% questionPapers.forEach((questionPaper,index)=> { %>
                        <tr>
                            <td class="text-center">
                                <%= index + 1%>
                            </td>
                            <td class="text-center">
                                <%= questionPaper.questionPaperTitle %>
                            </td>
                            <td class="text-center">
                                <%= questionPaper.questionIds.length %>
                            </td>
                            <!-- <td><%= questionPaper.description %></td> -->
                            <td class="text-center">
                                <%= questionPaper.minimumNumberForPassing %>
                            </td>
                            <td class="text-center">
                                <button class="btn border border-black rounded shadow"
                                    onclick="editQuestionPaper('<%= questionPaper._id %>')">
                                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor"
                                        class="bi bi-pen" viewBox="0 0 16 16">
                                        <path
                                            d="m13.498.795.149-.149a1.207 1.207 0 1 1 1.707 1.708l-.149.148a1.5 1.5 0 0 1-.059 2.059L4.854 14.854a.5.5 0 0 1-.233.131l-4 1a.5.5 0 0 1-.606-.606l1-4a.5.5 0 0 1 .131-.232l9.642-9.642a.5.5 0 0 0-.642.056L6.854 4.854a.5.5 0 1 1-.708-.708L9.44.854A1.5 1.5 0 0 1 11.5.796a1.5 1.5 0 0 1 1.998-.001zm-.644.766a.5.5 0 0 0-.707 0L1.95 11.756l-.764 3.057 3.057-.764L14.44 3.854a.5.5 0 0 0 0-.708l-1.585-1.585z" />
                                    </svg>
                                </button>


                                <button class="btn  border  border-black rounded shadow  "
                                    onclick="deleteQuestionPaper('<%= questionPaper._id %>')">
                                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor"
                                        class="bi bi-trash" viewBox="0 0 16 16">
                                        <path
                                            d="M5.5 5.5A.5.5 0 0 1 6 6v6a.5.5 0 0 1-1 0V6a.5.5 0 0 1 .5-.5Zm2.5 0a.5.5 0 0 1 .5.5v6a.5.5 0 0 1-1 0V6a.5.5 0 0 1 .5-.5Zm3 .5a.5.5 0 0 0-1 0v6a.5.5 0 0 0 1 0V6Z" />
                                        <path
                                            d="M14.5 3a1 1 0 0 1-1 1H13v9a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V4h-.5a1 1 0 0 1-1-1V2a1 1 0 0 1 1-1H6a1 1 0 0 1 1-1h2a1 1 0 0 1 1 1h3.5a1 1 0 0 1 1 1v1ZM4.118 4 4 4.059V13a1 1 0 0 0 1 1h6a1 1 0 0 0 1-1V4.059L11.882 4H4.118ZM2.5 3h11V2h-11v1Z" />
                                    </svg>
                                </button>
                            </td>

                        </tr>
                        <% }); %>
                </tbody>
            </table>
        </div>
    </div>
    <script>
        function editQuestionPaper(questionPaperId) {
            // Set the questionPaperId in local storage
            localStorage.setItem('questionPaperId', questionPaperId);

            // Redirect to the Question Paper Details page with the questionPaperId as a query parameter
            window.location.href = `/testmaster/api/questionpapersdetails/${questionPaperId}`;
        }

        function deleteQuestionPaper(questionPaperId) {
            console.log(questionPaperId)
            const confirmed = confirm(
                "Are you sure you want to delete this question paper?"
            );
            if (confirmed) {
                fetch(
                    `http://localhost:3000/testmaster/api/questionpapers/${questionPaperId}`,
                    {
                        method: "DELETE",
                    }
                )
                    .then((response) => {
                        if (response.ok) {
                            window.location.reload();
                        } else {
                            console.error("Error deleting question paper");
                        }
                    })
                    .catch((error) => {
                        console.error("Error deleting question paper:", error);
                    });
            }
        }

    </script>


    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.16.0/umd/popper.min.js"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js"></script>
</body>

</html>